{% extends 'base.html' %}

{% block content %}
<h1>Team Stats Index</h1>
<h3>Passing</h3>
<div>
  <canvas class="chart" data-category="passing" data-stat="yds" width="800" height="400"></canvas>
</div>
<ul class="list-group">
  {% for instance in passing_list %}
      <li class="list-group-item d-flex justify-content-between align-items-baseline">
          <div class="d-flex justify-content-start align-items-baseline">
              <p class="list-num-text">{{forloop.counter}}.</p>
              <a class="link-dark" href='{{ instance.get_absolute_url }}'>{{ instance.player_full_name }}</a>
              <p class="pos-text">{{ instance.team_abrv }}</p></div>                     
          <span>{{instance.yds}}</span>
      </li>
  {% endfor %}
</ul>
<h3>Rushing</h3>
<div>
  <canvas class="chart" data-category="rushing" data-stat="att" width="800" height="400"></canvas>
</div>
<ul class="list-group">
  {% for instance in rushing_list %}
      <li class="list-group-item d-flex justify-content-between align-items-baseline">
          <div class="d-flex justify-content-start align-items-baseline">
              <p class="list-num-text">{{forloop.counter}}.</p>
              <a class="link-dark" href='{{ instance.get_absolute_url }}'>{{ instance.player_full_name }}</a>
              <p class="pos-text">{{ instance.team_abrv }}</p></div>                     
          <span>{{instance.yds}}</span>
      </li>
  {% endfor %}
</ul>
<h3>Receiving</h3>
<div>
  <canvas class="chart" data-category="receiving" data-stat="tgts" width="800" height="400"></canvas>
</div>
<div>
  <canvas class="chart" data-category="receiving" data-stat="rec" width="800" height="400"></canvas>
</div>
<div>
  <canvas class="chart" data-category="receiving" data-stat="td" width="800" height="400"></canvas>
</div>
<ul class="list-group">
  {% for instance in receiving_list %}
      <li class="list-group-item d-flex justify-content-between align-items-baseline">
          <div class="d-flex justify-content-start align-items-baseline">
              <p class="list-num-text">{{forloop.counter}}.</p>
              <a class="link-dark" href='{{ instance.get_absolute_url }}'>{{ instance.player_full_name }}</a>
              <p class="pos-text">{{ instance.team_abrv }}</p></div>                     
          <span>{{instance.yds}}</span>
      </li>
  {% endfor %}
</ul>
<script
  src="https://code.jquery.com/jquery-3.6.1.min.js"
  integrity="sha256-o88AwQnZB+VDvE9tvIXrMQaPlFFSUTR+nldQm1LuPXQ="
  crossorigin="anonymous"></script>
<script src="https://cdn.jsdelivr.net/npm/chart.js@2.9.3/dist/Chart.min.js"></script>


<script>
    $(function () {
      var $charts = $(".chart");
      console.log($charts)
      $charts.each(function(index) {
        var category = $(this).attr('data-category')
        var stat = $(this).attr('data-stat')
        var ctx = $(this)[0].getContext("2d")
        $.ajax({
          url: window.location.pathname + '/' + category + '/' + stat,
          success: function (data) {

            new Chart(ctx, {
              type: 'bar',
              data: {
                labels: data.labels,
                datasets: [{
                  label: stat.toLocaleUpperCase(),
                  backgroundColor: 'blue',
                  data: data.data
                }]          
              },
              options: {
                responsive: true,
                legend: {
                  position: 'top',
                }
              }
            });

        }
      });
        
      });

  });

</script>

{% endblock %}
